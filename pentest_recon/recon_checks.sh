# !/bin/bash
# 
# This script contains a number of tools to recon domains,IP address, emails for
# an organization in a recursive manner. It stores the output within the
# specified folder.
# 
# Args:
#     domain: Main domain to use. Required.
#     company_keywords: Comma-separated/Pipe-separated Keywords to use to 
#                       discover related domains for org. E.g. for Google, supply
#                       'gmail,google,drive'. Required.
#     recursive: Run tests recursively
#
# Examples:
#     ./recon_checks.sh "$domain" "$company_keywords"
#     

if [ $# -lt 2 ]; then
    echo "[-] $0 <domain> <company_keywords> [recursive=1]"
    exit 1 
fi
domain="$1"
company_keywords="$2"
recursive=${3:-"1"}

echo "[*] Making new output folder for domain: $domain" 
outfolder="out-$domain"
if [ -d "$outfolder" ]; then
    rm -rf "$outfolder"
fi
mkdir "$outfolder"

echo "[*] Getting all nameservers via host for domain: $domain"
(host -t ns "$domain" \
    | grep -i "name server" \
    | cut -d" " -f4) > "$outfolder/out-nameservers-dig-$domain.txt"

echo "[*] Getting all nameservers via whois for domain: $domain"
(whois "$domain" \
    | grep -i "name server:" \
    | cut -d" " -f3 \
    | sort | uniq) > "$outfolder/out-nameservers-whois-$domain.txt"

