#!/bin/bash
# Script runs multiple vulnerability scanning checks against several hosts

# Delimiter to use 
DELIM="|" 

# Load the user's bash profile aka .bashrc file
source ~/.bashrc

# User specifies one or more targets to run the scan against
targets=$(cat -)

# HTTP Scans
## Run scan for asstets vulnerable to Oracle WebLogic RCE (CVE-2020-2883)
targets_with_oracle_t3_service=$(echo "$targets" \
    | pparallel ./get_http_oracle_t3_protocol_hosts.sh nmap \
    | ./invoke_push_notification_send.sh \
        "Found targets running Oracle's T3 protocol possibly vulnerable to \
CVE-2020-2883. Exploit: https://github.com/Y4er/CVE-2020-2883")