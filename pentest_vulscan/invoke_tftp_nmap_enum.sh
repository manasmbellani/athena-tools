#!/bin/bash
# 
# Script to run Nmap enumeration on TFTP protocol
# 

if [ $# -lt 1 ]; then
    echo "[-] cat ...<target|port|proto>... | $0 run"
    exit 1
fi

combos=$(cat -)

# Script directory
script_dir=$(dirname "$0")

# Loop through each combination and identify all TFTP hosts
IFS=$'\n'
for combo in $combos; do
    if [ ! -z "$combo" ]; then
        
        echo "$combo" | $script_dir/invoke_cmd_on_target.sh \
            "sudo nmap -Pn -sU -pPORT --script=tftp-enum TARGET"
    fi
done