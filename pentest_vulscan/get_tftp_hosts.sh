#!/bin/bash
# 
# Script to get the list of all targets|ports|proto combos that are running TFTP
# 

if [ $# -lt 1 ]; then
    echo "[-] cat ...<target|port|proto>... | $0 run"
    exit 1
fi

combos=$(cat -)

# Regex to identify TFTP
regex="tftp"

# Loop through each combination and identify all TFTP hosts
IFS=$'\n'
for combo in $combos; do
    if [ ! -z "$combo" ]; then
        echo "$combo" | grep -iE "$regex" 
    fi
done