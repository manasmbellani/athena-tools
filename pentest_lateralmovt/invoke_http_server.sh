# !/bin/bash
# 
# Script launches a HTTP server to serve files
# 
# Taken from: 
# 
# Args:
#     port: Port to serve the HTTP Service. Default, 8001.
#     folder: Folder to serve the files from. Default, '.' aka current folder
#     server_type: Server Type e.g. http/https. 'http', by default.
# 
# Examples:
#     To launch HTTP service on port 1433 in the folder /tmp:
#         ./invoke_http_server.sh 1433 /tmp
# 
port=${1:-"8001"}
service_folder=${2:-"."}
server_type=${3:-"https"}

echo "[*] Killing HTTP server for port: $port"
pkill -f ".*(http\.server|SimpleHTTPServer|httpd\.socket).*$port.*"

if [ "$server_type" == "http" ]; then
    echo "[*] Launch HTTP server on port: $port, folder: $service_folder"
    cd "$service_folder"    
    python3 -m http.server "$port" &
elif [ "$server_type" == "https" ]; then
    echo "[*] Launch HTTPS server on port: $port, folder: $service_folder"
    cd "$service_folder"
    echo "[*] Currently, HTTPS server is not implemented."
else 
    echo "[*] Unknown server type: $server_type requested."
    exit 1
fi